!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("querystring")):"function"==typeof define&&define.amd?define(["exports","querystring"],r):r((e=e||self).CommercetoolsSdkClient={},e.qs)}(this,function(e,O){"use strict";function r(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(r);e&&(o=o.filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})),t.push.apply(t,o)}return t}function v(n){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?r(i,!0).forEach(function(e){var r,t,o;r=n,o=i[t=e],t in r?Object.defineProperty(r,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[t]=o}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):r(i).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(i,e))})}return n}function t(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var t=[],o=!0,n=!1,i=void 0;try{for(var s,c=e[Symbol.iterator]();!(o=(s=c.next()).done)&&(t.push(s.value),!r||t.length!==r);o=!0);}catch(e){n=!0,i=e}finally{try{o||null==c.return||c.return()}finally{if(n)throw i}}return t}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function n(e){return function(e){if(Array.isArray(e)){for(var r=0,t=new Array(e.length);r<e.length;r++)t[r]=e[r];return t}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}O=O&&O.hasOwnProperty("default")?O.default:O;var i=["ACL","BIND","CHECKOUT","CONNECT","COPY","DELETE","GET","HEAD","LINK","LOCK","M-SEARCH","MERGE","MKACTIVITY","MKCALENDAR","MKCOL","MOVE","NOTIFY","OPTIONS","PATCH","POST","PROPFIND","PROPPATCH","PURGE","PUT","REBIND","REPORT","SEARCH","SOURCE","SUBSCRIBE","TRACE","UNBIND","UNLINK","UNLOCK","UNSUBSCRIBE"];function s(e,r,t){var o=2<arguments.length&&void 0!==t?t:{allowedMethods:i};if(!r)throw new Error('The "'.concat(e,'" function requires a "Request" object as an argument. See https://commercetools.github.io/nodejs/sdk/Glossary.html#clientrequest'));if("string"!=typeof r.uri)throw new Error('The "'.concat(e,'" Request object requires a valid uri. See https://commercetools.github.io/nodejs/sdk/Glossary.html#clientrequest'));if(!o.allowedMethods.includes(r.method))throw new Error('The "'.concat(e,'" Request object requires a valid method. See https://commercetools.github.io/nodejs/sdk/Glossary.html#clientrequest'))}e.createClient=function(o){if(!o)throw new Error("Missing required options");if(o.middlewares&&!Array.isArray(o.middlewares))throw new Error("Middlewares should be an array");if(!o.middlewares||!Array.isArray(o.middlewares)||!o.middlewares.length)throw new Error("You need to provide at least one middleware");return{execute:function(t){return s("exec",t),new Promise(function(e,r){(function(){for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];return 1===(r=r.filter(function(e){return"function"==typeof e})).length?r[0]:r.reduce(function(e,r){return function(){return e(r.apply(void 0,arguments))}})}).apply(void 0,n(o.middlewares))(function(e,r){if(r.error)r.reject(r.error);else{var t={body:r.body||{},statusCode:r.statusCode};r.headers&&(t.headers=r.headers),r.request&&(t.request=r.request),r.resolve(t)}})(t,{resolve:e,reject:r,body:void 0,error:void 0})})},process:function(y,m,e){var w=this;if(s("process",y,{allowedMethods:["GET"]}),"function"!=typeof m)throw new Error('The "process" function accepts a "Function" as a second argument that returns a Promise. See https://commercetools.github.io/nodejs/sdk/api/sdkClient.html#processrequest-processfn-options');var b=v({total:Number.POSITIVE_INFINITY,accumulate:!0},e);return new Promise(function(u,l){var e=t(y.uri.split("?"),2),d=e[0],r=e[1],f=v({limit:20},v({},O.parse(r))),h=!1,p=b.total;!function s(e,r){var c=1<arguments.length&&void 0!==r?r:[],t=f.limit<p?f.limit:p,o=O.stringify(v({},f,{limit:t})),n=v({sort:"id asc",withTotal:!1},e?{where:'id > "'.concat(e,'"')}:{}),i=O.stringify(n),a=v({},y,{uri:"".concat(d,"?").concat(i,"&").concat(o)});w.execute(a).then(function(e){var r=e.body,n=r.results,i=r.count;i||!h?Promise.resolve(m(e)).then(function(e){var r;if(h=!0,b.accumulate&&(r=c.concat(e||[])),p-=i,i<f.limit||!p)u(r||[]);else{var t=n[i-1],o=t&&t.id;s(o,r)}}).catch(l):u(c||[])}).catch(l)}()})}}},Object.defineProperty(e,"__esModule",{value:!0})});
